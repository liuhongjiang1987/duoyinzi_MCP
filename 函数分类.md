# main.py 函数分类文档

## 📦 依赖导入与基础配置

### 导入模块
- `pandas` - 数据处理和分析
- `numpy` - 数值计算
- `json` - JSON数据处理
- `base64` - Base64编码解码
- `io` - 输入输出操作
- `typing` - 类型注解
- `mcp` - MCP框架
- `sklearn.preprocessing` - 数据预处理
- `scipy.stats` - 统计计算

### 常量定义
- `RESOURCE_TYPES` - 资源类型定义
- `DATA_CACHE` - 数据缓存
- `RESOURCE_INDEX` - 资源索引

## 🗄️ 数据存储与缓存管理
- `load_resource_from_persistent_storage` - 从持久化存储加载资源
- `load_all_persistent_resources` - 加载所有持久化资源到内存缓存(delet)
- `reload_persistent_resources` - 重新加载所有持久化资源到内存缓存(delet)
- `list_persistent_resources` - 列出存储中的所有资源
- `delete_persistent_resource` - 删除存储中的指定资源

## 🔧 资源管理
- `generate_resource_id` - 生成唯一资源ID
- `get_resource_uri` - 获取资源URI
- `get_resource_dependency_chain` - 获取资源依赖链信息

## 📊 数据上传与解析模块
- `upload_csv` - 上传CSV格式数据并解析为结构化数据集
- `upload_excel` - 上传Excel文件并解析数据
- `get_data_resource` - 通过URI访问已缓存数据资源
- `list_data_resources` - 列出当前缓存的所有数据资源及统计信息
- `clear_data_cache` - 清空数据缓存

## 🔍 字段分析与极性检测模块
- `analyze_data_fields` - 分析数据集字段特征
- `check_polarity_consistency` - 检查字段极性一致性
- `generate_data_quality_summary` - 生成数据质量摘要
- `apply_polarity_adjustment_tool` - 根据用户确认的极性配置应用极性调整

## 📈 隶属度计算模块
- `generate_membership_config_template` - 生成下界型隶属度计算配置模板
- `validate_membership_config` - 验证下界型隶属度计算配置
- `calculate_membership_with_config` - 使用下界型函数配置执行隶属度计算
- `find_latest_membership_resource` - 查找最新的隶属度计算资源

## 🎯 TOPSIS综合评估模块
- `perform_topsis_comprehensive_evaluation` - 使用TOPSIS方法进行综合评估计算
- `_generate_topsis_formatted_table` - 生成TOPSIS相对接近度矩阵表格 
- `_generate_topsis_available_tables` - 生成可查询表格清单
- `_generate_relative_closeness_table` - 生成相对接近度矩阵V值详细表格
- `_generate_membership_matrix_table` - 生成综合隶属度矩阵u值详细表格
- `_generate_distance_matrix_table` - 生成距离矩阵详细表格
- `_generate_complete_result_table` - 生成完整TOPSIS结果表格
- `_generate_topsis_next_actions` - 生成TOPSIS计算后的下一步建议
- `_generate_topsis_original_data_preview` - 生成TOPSIS结果的原始数据格式预览

## ⚖️ VIKOR综合评估模块
- `perform_vikor_comprehensive_evaluation` - 使用VIKOR方法进行综合评估计算

## 📋 辅助工具与实用函数
- `export_resource_to_csv` - 将指定资源导出为CSV格式
- `generate_analysis_summary` - 生成数据集分析总结

## 🔧 内部辅助函数
- `_generate_field_descriptions` - 生成字段详细解释（没有）
- `_generate_next_actions` - 生成下一步行动建议
- `_generate_resource_info` - 生成资源基本信息
- `_generate_data_summary` - 生成数据统计摘要
- `_generate_standardized_topsis_table` - 生成标准化TOPSIS结果表格
- `_is_membership_matrix` - 检查DataFrame是否为隶属度矩阵格式
- `_flatten_membership_matrix` - 将隶属度矩阵的嵌套结构转换为扁平化结构
- `_convert_membership_to_normalized_matrix` - 将隶属度矩阵转换为规范化特征值矩阵格式

## 🚀 主程序入口
- `main` - 主程序入口（通过 `if __name__ == "__main__":` 启动MCP服务器）

## 函数统计

| 模块类别 | 函数数量 |
|---------|---------|
| 📦 依赖导入与基础配置 | 10+ |
| 🗄️ 数据存储与缓存管理 | 5 |
| 🔧 资源管理 | 3 |
| 📊 数据上传与解析模块 | 5 |
| 🔍 字段分析与极性检测模块 | 4 |
| 📈 隶属度计算模块 | 4 |
| 🎯 TOPSIS综合评估模块 | 9 |
| ⚖️ VIKOR综合评估模块 | 1 |
| 📋 辅助工具与实用函数 | 2 |
| 🔧 内部辅助函数 | 8 |
| 🚀 主程序入口 | 1 |
| **总计** | **52+** |

## 说明

1. 本分类基于main.py文件的实际函数定义进行整理
2. 函数数量统计包含主要函数和内部辅助函数
3. 依赖导入部分包含多个导入模块和常量定义
4. 所有函数都按照其功能职责进行了合理分类
5. 每个模块都有清晰的职责划分，便于代码维护和理解